<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Play Instrument</title>
  <style>
    :root { color-scheme: light dark; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, sans-serif; background: radial-gradient(circle at 15% 20%, #fefefe, #f2f4ff 38%, #f9f9f9); min-height: 100vh; color: #111; }
    main { max-width: 760px; margin: 0 auto; padding: 32px 18px 48px; }
    a { color: #0b68d0; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    h1 { margin: 0; font-size: 24px; }
    .card { margin-top: 16px; background: #fff; border: 1px solid #e5e5e5; border-radius: 12px; padding: 18px 20px; box-shadow: 0 10px 36px rgba(0,0,0,0.05); }
    .muted { color: #666; font-size: 13px; }
    .title { font-size: 22px; margin: 0 0 8px; }
    .desc { white-space: pre-wrap; line-height: 1.7; margin: 0; font-size: 15px; }
    .error { color: #b00020; margin-top: 12px; }
  </style>
</head>
<body>
  <main>
    <header>
      <div>
        <h1>Play Instrument</h1>
        <div class="muted">Load an instrument and view its details.</div>
      </div>
      <a href="/instruments.html">Back to instruments</a>
    </header>

    <section id="instrumentCard" class="card">
      <div id="loadingState" class="muted">Loading instrument…</div>
    </section>
  </main>

  <script>
    const API_BASE = "/instruments";
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    if (!id) {
      document.getElementById("instrumentCard").innerHTML = '<div class="error">No instrument id provided.</div>';
    } else {
      fetchInstrument(id);
    }

    async function fetchInstrument(instrumentId) {
      const card = document.getElementById("instrumentCard");
      const loading = document.getElementById("loadingState");
      loading.textContent = "Loading instrument…";

      try {
        const res = await fetch(`${API_BASE}/${encodeURIComponent(instrumentId)}`);
        if (!res.ok) {
          const msg = await res.text();
          throw new Error(msg || "Instrument not found.");
        }
        const data = await res.json();
        renderInstrument(card, data);
      } catch (err) {
        card.innerHTML = `<div class="error">${err.message || "Unable to load instrument."}</div>`;
      }
    }

    function renderInstrument(card, instrument) {
      card.innerHTML = "";
      const title = document.createElement("h2");
      title.className = "title";
      title.textContent = instrument.name || "(untitled instrument)";

      const meta = document.createElement("div");
      meta.className = "muted";
      meta.textContent = `#${instrument.id}`;

      const desc = document.createElement("p");
      desc.className = "desc";
      desc.textContent = instrument.description || "No description provided.";

      card.appendChild(title);
      card.appendChild(meta);
      card.appendChild(desc);
    }
  </script>
</body>
</html>
